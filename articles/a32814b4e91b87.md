---
title: "Rubyãƒ†ã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯minitestã€test-unitã€rspecã«ãŠã‘ã‚‹ã€æ³•å‰‡æ€§ã‚’æŒãŸãªã„ï¼ˆãƒ©ãƒ³ãƒ€ãƒ ãªï¼‰ãƒ†ã‚¹ãƒˆé †åºå®Ÿç¾æ–¹æ³•"
emoji: "ğŸŒŸ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: [ruby, minitest, test-unit, rspec]
published: true
---

[ãƒ†ã‚¹ãƒˆåŒå£«ã¯ç‹¬ç«‹ã—ã¦ç›¸äº’ã«å½±éŸ¿ã‚’ä¸ãˆãªã„ï¼ˆIndependent ã§ã‚ã‚‹ï¼‰ã“ã¨ãŒæœ›ã¾ã—ã„](https://t-wada.hatenablog.jp/entry/design-for-testability#%E3%83%9D%E3%82%A4%E3%83%B3%E3%83%88-%E8%89%AF%E3%81%84%E3%83%A6%E3%83%8B%E3%83%83%E3%83%88%E3%83%86%E3%82%B9%E3%83%88%E3%81%AF-Independent-%E7%8B%AC%E7%AB%8B%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B)ãŒã€ä½œæˆè€…ãŒæ„å›³ã›ãšä¾å­˜é–¢ä¿‚ã‚’æŒã¡ã“ã‚“ã§ã—ã¾ã†å ´åˆãŒã‚ã‚‹ã€‚

ãƒ†ã‚¹ãƒˆã®é †åºã‚’å…¥ã‚Œæ›¿ãˆã‚‹ã¨ç‹¬ç«‹ã—ã¦ã„ãªã„ãƒ†ã‚¹ãƒˆãŒç™ºè¦‹ã—ã‚„ã™ããªã‚‹ãŸã‚ã€ãƒ†ã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã¯ãƒ†ã‚¹ãƒˆã®é †åºã‚’å…¥ã‚Œæ›¿ãˆã‚‹ä»•çµ„ã¿ã‚’å‚™ãˆãŸã‚‚ã®ãŒå¤šã„ã€‚ã¾ãŸã€é †åºã‚’éƒ½åº¦ãƒ¦ãƒ¼ã‚¶ãƒ¼å´ã§æŒ‡å®šã™ã‚‹ã®ã¯é¢å€’ãªã®ã§ã€æ³•å‰‡æ€§ã‚’æŒãŸãªã„ï¼ˆãƒ©ãƒ³ãƒ€ãƒ ãªï¼‰é †åºã§ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹æ©Ÿèƒ½ã‚’å‚™ãˆã¦ã„ã‚‹å ´åˆã‚‚ã‚ã‚‹ã€‚

åŠ ãˆã¦ã€æ³•å‰‡æ€§ã‚’æŒãŸãªã„é †åºã§å®Ÿè¡Œã—ãŸãƒ†ã‚¹ãƒˆå¤±æ•—ã‚’ãã£ã‹ã‘ã«ä¾å­˜é–¢ä¿‚ã‚’ç™ºè¦‹ã—ãŸå ´åˆã€ãã®å¾Œã«åŒã˜é †åºã§ã®ãƒ†ã‚¹ãƒˆå®Ÿè¡ŒãŒã§ãã‚‹ã¨ä¿®æ­£ãŒæ„å›³é€šã‚Šã«è¡ŒãˆãŸã‹ç¢ºèªãŒå®¹æ˜“ã«ãªã‚‹ã€‚ä¸€éƒ¨ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ã€ãƒ©ãƒ³ãƒ€ãƒ ã•ã‚’å¾—ã‚‹ãŸã‚ã®åˆæœŸå€¤ï¼ˆSeedï¼‰ã‚’å®Ÿè¡Œæ™‚ã«è¨­å®šã™ã‚‹ã“ã¨ã§ã€æ³•å‰‡æ€§ã‚’æŒãŸãªã„ãŒã€åŒã˜é †åºã§ã®ãƒ†ã‚¹ãƒˆå†å®Ÿæ–½ãŒå¯èƒ½ã«ãªã‚‹ä»•çµ„ã¿ã‚’å‚™ãˆã¦ã„ã‚‹ã€‚

Ruby ã§åˆ©ç”¨ã•ã‚Œã‚‹ã“ã¨ã®å¤šã„^[bundler gem ã‚³ãƒãƒ³ãƒ‰ã§ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä½œæˆæ™‚ã«æŒ‡å®šã§ãã‚‹]ãƒ†ã‚¹ãƒ†ã‚£ãƒ³ã‚°ãƒ©ã‚¤ãƒ–ãƒ©ãƒª [minitest](https://github.com/minitest/minitest)ã€[test-unit](https://github.com/test-unit/test-unit/)ã€[rspec-core](https://github.com/rspec/rspec-core) ã®æœ€æ–°ç‰ˆã§ã€æ³•å‰‡æ€§ã‚’æŒãŸãªã„é †åºã§ã®ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã€åŠã³åŒã˜é †åºã‚’å†ç¾ã§ãã‚‹ä»•çµ„ã¿ã‚’å‚™ãˆã¦ã„ã‚‹ã‹ã€å‚™ãˆã¦ã„ã‚‹å ´åˆã©ã®ã‚ˆã†ã«å®Ÿç¾ã—ã¦ã„ã‚‹ã‹ã‚’èª¿ã¹ãŸã€‚

# èª¿æŸ»

## ã¾ã¨ã‚

| åå‰      | æ³•å‰‡æ€§ã‚’æŒãŸãªã„é †åºã¸ã¨ãƒ†ã‚¹ãƒˆã‚’ä¸¦ã¹æ›¿ãˆã‚‹éƒ¨åˆ†                                                                                                                | ãƒ©ãƒ³ãƒ€ãƒ ã•ã‚’å¾—ã‚‹ãŸã‚ã®åˆæœŸå€¤ï¼ˆSeedï¼‰ã®æ¸¡ã—æ–¹                                | æ¸¡ã—ãŸ Seed ã®å–å¾—æ–¹æ³•                                                                                               |
| --------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------- |
| minitest  | [Minitest::Test.runnable_methods](https://github.com/minitest/minitest/blob/v5.24.1/lib/minitest/test.rb#L75-L76)                                             | `-s` ã‹ `--seed` ã¨ã„ã†ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æ¸¡ã™ã€ã‚ã‚‹ã„ã¯ç’°å¢ƒå¤‰æ•° `SEED` ã‚’è¨­å®šã™ã‚‹ | [Minitest.seed](https://github.com/minitest/minitest/blob/v5.24.1/lib/minitest.rb#L22-L28)                           |
| test-unit | [Test::Unit::TestSuiteCreator#sort_test_names_in_random_order](https://github.com/test-unit/test-unit/blob/3.6.2/lib/test/unit/test-suite-creator.rb#L81-L83) | -                                                                           | -                                                                                                                    |
| rspec     | [RSpec::Core::Ordering::Random#order](https://github.com/rspec/rspec-core/blob/v3.13.0/lib/rspec/core/ordering.rb#L25-L30)                                    | `--order random:123` ã‚„ `--seed 123`                                        | [RSpec.configure.seed](https://github.com/rspec/rspec-core/blob/v3.13.0/lib/rspec/core/configuration.rb#L1679-L1691) |

## minitest

2024-08-03 ç¾åœ¨ v5.24.1 ãŒæœ€æ–°ç‰ˆã€‚

ãƒ†ã‚¹ãƒˆé †ç•ªã®ãƒ©ãƒ³ãƒ€ãƒ åŒ–ã¯ [Minitest::Test.runnable_methods](https://github.com/minitest/minitest/blob/v5.24.1/lib/minitest/test.rb#L75-L76) ã§å®Ÿæ–½ã—ã¦ã„ã‚‹ã€‚

ãƒ©ãƒ³ãƒ€ãƒ ã•ã‚’å¾—ã‚‹ãŸã‚ã®åˆæœŸå€¤ã¯ã€`-s` ã‹ `--seed` ã¨ã„ã†ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æ¸¡ã™ã€ã‚ã‚‹ã„ã¯ç’°å¢ƒå¤‰æ•° `SEED` ã®è¨­å®šã‚’é€šã—ã¦ã€å¤–éƒ¨ã‚³ãƒãƒ³ãƒ‰ã‹ã‚‰æ¸¡ã›ã‚‹ã€‚ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‹ã‚‰ã®å–å¾—ã¯ [Minitest.process_args](https://github.com/minitest/minitest/blob/v5.24.1/lib/minitest.rb#L185-L187) ã§ã€ç’°å¢ƒå¤‰æ•°ã‹ã‚‰ã®å–å¾—ã¯ [Minitest.process_args](https://github.com/minitest/minitest/blob/v5.24.1/lib/minitest.rb#L236-L240) ã§è¡Œã£ã¦ã„ã‚‹ã€‚

è¨­å®šã—ãŸ Seed å€¤ã¯ [Minitest.seed](https://github.com/minitest/minitest/blob/v5.24.1/lib/minitest.rb#L22-L28) çµŒç”±ã§å–å¾—ã§ãã‚‹ã€‚

## test-unit

2024-08-03 ç¾åœ¨ v3.6.2 ãŒæœ€æ–°ç‰ˆã€‚

ãƒ©ãƒ³ãƒ€ãƒ ã•ã‚’å¾—ã‚‹ãŸã‚ã®åˆæœŸå€¤ã‚’æ¸¡ã™ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã¯å­˜åœ¨ã—ãªã„ã€‚

ãƒ†ã‚¹ãƒˆé †ç•ªã®ãƒ©ãƒ³ãƒ€ãƒ åŒ–ã¯ [Test::Unit::TestSuiteCreator#sort_test_names_in_random_order](https://github.com/test-unit/test-unit/blob/3.6.2/lib/test/unit/test-suite-creator.rb#L81-L83) ã§å®Ÿæ–½ã—ã¦ã„ã‚‹ã€‚

## rspec

2024-08-03 ç¾åœ¨ v3.13.0 ãŒæœ€æ–°ç‰ˆã€‚

ãƒ©ãƒ³ãƒ€ãƒ ã•ã‚’å¾—ã‚‹ãŸã‚ã®åˆæœŸå€¤ã¯ã€`--order random:123` ã‹ `--seed 123` ã¨ã—ã¦å¤–éƒ¨ã‚³ãƒãƒ³ãƒ‰ã‹ã‚‰æ¸¡ã›ã‚‹ã€‚
ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‹ã‚‰ã®å–å¾—ã¯ [RSpec::Core::Parser#parser](https://github.com/rspec/rspec-core/blob/v3.13.0/lib/rspec/core/option_parser.rb#L59-L70) ã§è¡Œã£ã¦ã„ã‚‹ã€‚

Seed å€¤ã¯ [RSpec::Core::Runner#initialize](https://github.com/rspec/rspec-core/blob/v3.13.0/lib/rspec/core/runner.rb#L75-L79) ã§è¨­å®šã•ã‚ŒãŸ `configure` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆçµŒç”±ã§
[RSpec::Core::Configuration#seed](https://github.com/rspec/rspec-core/blob/v3.13.0/lib/rspec/core/configuration.rb#L1679-L1691) ã‹ã‚‰å–å¾—ã€ã¤ã¾ã‚Š `RSpec.configure.seed` ã§å¾—ã‚‰ã‚Œã‚‹ã€‚

ãƒ†ã‚¹ãƒˆé †ç•ªã®ãƒ©ãƒ³ãƒ€ãƒ åŒ–ã¯ [RSpec::Core::Ordering::Random#order](https://github.com/rspec/rspec-core/blob/v3.13.0/lib/rspec/core/ordering.rb#L25-L30) ã§å®Ÿæ–½ã—ã¦ã„ã‚‹ã€‚
