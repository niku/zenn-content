---
title: "runtime_infoã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›ã™ã‚‹"
emoji: "ğŸ’¡"
type: "tech"
topics:
  - "elixir"
published: true
published_at: "2021-07-20 20:06"
---

iex ã«ã¯ [`runtime_info/0`](https://hexdocs.pm/iex/IEx.Helpers.html#runtime_info/0) ã¨ã„ã†é–¢æ•°ãŒç”¨æ„ã•ã‚Œã¦ã„ã‚‹ã€‚å®Ÿè¡Œã™ã‚‹ã¨ç¾åœ¨å‹•ä½œã—ã¦ã„ã‚‹ VM ã®æƒ…å ±ã‚’ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã¸ã¨è¡¨ç¤ºã™ã‚‹ã€‚

ã“ã®å®Ÿè£…ã¯é–¢æ•°ã®ä¸­ã§ [`IO.puts/2`](https://hexdocs.pm/elixir/IO.html#puts/2) ã‚„ [`IO.write/2`](https://hexdocs.pm/elixir/IO.html#write/2) ã‚’ä½¿ã£ã¦è¡Œã‚ã‚Œã¦ã„ã‚‹ã€‚ã¾ãŸ `runtime_info/0` ã¯ IO ã®å‡ºåŠ›å…ˆã‚’å¤‰æ›´ã§ãã‚‹ã‚ˆã†ãªå¼•æ•°ã¯å–ã‚‰ãªã„ã€‚ã“ã®åˆ¶ç´„ä¸‹ã§ã€é€šå¸¸ã® `IO.puts/2` ã¯æ¨™æº–å‡ºåŠ›ã¸ã¨å‡ºåŠ›ã—ã€`runtime_info` ã®çµæœã®ã¿ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã¨å‡ºåŠ›ã™ã‚‹ã“ã¨ã¯ã§ãã‚‹ã ã‚ã†ã‹ã€‚ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ›¸ãæ›ãˆãªãã¨ã‚‚ [`Process.group_leader/2`](https://hexdocs.pm/elixir/Process.html#group_leader/2) ã‚’ã†ã¾ãä½¿ã†ã¨ã§ãã‚‹ã“ã¨ãŒã‚ã‹ã£ãŸã€‚

```
â¯ iex
Erlang/OTP 22 [erts-10.6.2] [source] [64-bit] [smp:8:8] [ds:8:8:10] [async-threads:1] [hipe]

Interactive Elixir (1.10.0-rc.0) - press Ctrl+C to exit (type h() ENTER for help)
iex(1)> runtime_info()

## System and architecture

Elixir version:     1.10.0-rc.0
Erlang/OTP version: 22
ERTS version:       10.6.2
Compiled for:       x86_64-apple-darwin18.7.0
Schedulers:         8
Schedulers online:  8

## Memory

Total:              36 MB
Atoms:              331 KB
Binaries:           256 KB
Code:               5 MB
ETS:                538 KB
Processes:          19 MB

## Statistics / limits

Uptime:             4 seconds
Run queue:          1
Atoms:              11856 / 1048576 (1% used)
ETS:                23 / 8192 (0% used)
Ports:              3 / 65536 (0% used)
Processes:          57 / 262144 (0% used)

Showing topics:     [:system, :memory, :limits]
Additional topics:  [:allocators, :applications]

To view a specific topic call runtime_info(topic)
```

```elixir
# puts_tuntime_info_to_file.exs

#
# ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
#
# å‡ºåŠ›ã®å¤‰æ›´å…ˆã«ä½¿ã†ãŸã‚ã€ãƒ•ã‚¡ã‚¤ãƒ«ã®io_deviceã‚’å–å¾—ã™ã‚‹
file = File.open!("./runtime_info.txt", [:write])
# å¤‰æ›´å¾Œã¾ãŸå…ƒã«æˆ»ã›ã‚‹ã‚ˆã†ã«ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®group_leaderã‚’å¤‰æ•°ã«ä¿æŒã—ã¦ãŠã
# ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®group_leaderã¯æ–‡å­—ã‚’æ¨™æº–å‡ºåŠ›ã¸ã¨å‡ºåŠ›ã™ã‚‹io_deviceã¨ãªã£ã¦ã„ã‚‹ï¼‰
original = Process.group_leader()
# æ–°ã—ã„group_leaderã¨ã—ã¦ã€æ–‡å­—ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã¨å‡ºåŠ›ã™ã‚‹io_deviceã‚’è¨­å®šã™ã‚‹
Process.group_leader(self(), file)

#
# å®Ÿè¡Œ
#
IEx.Helpers.runtime_info()

#
# å¾Œå§‹æœ«
#
# group_leaderã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¸ã¨æˆ»ã™
Process.group_leader(self(), original)
# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®group_leaderã«æˆ»ã£ã¦ã„ã‚‹ã®ã§ã€ã“ã®æ–‡å­—åˆ—ã¯æ¨™æº–å‡ºåŠ›ã‹ã‚‰å‡ºåŠ›ã•ã‚Œã‚‹
IO.puts("back to original group leader")
```

- å®Ÿè¡Œå‰ã¯ runtime_info.txt ãŒå­˜åœ¨ã—ãªã„
- å®Ÿè¡Œã™ã‚‹ã¨æ¨™æº–å‡ºåŠ›ã« `back to original group leader` ã¨è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹
- å®Ÿè¡Œå¾Œã¯ runtime_info.txt ãŒå­˜åœ¨ã— `runtime_info()` ã®çµæœãŒå‡ºåŠ›ã•ã‚Œã¦ã„ã‚‹

ã®ã§æœŸå¾…é€šã‚Šã«å‹•ã„ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚‹ã€‚

```
â¯ cat runtime_info.txt
cat: runtime_info.txt: No such file or directory

~/src/niku.github.io source*
â¯ elixir puts_runtime_info_to_file.exs
back to original group leader

~/src/niku.github.io source*
â¯ cat runtime_info.txt

## System and architecture

Elixir version:     1.10.0-rc.0
Erlang/OTP version: 22
ERTS version:       10.6.2
Compiled for:       x86_64-apple-darwin18.7.0
Schedulers:         8
Schedulers online:  8

## Memory

Total:              24 MB
Atoms:              387 KB
Binaries:           14 KB
Code:               7 MB
ETS:                547 KB
Processes:          4 MB

## Statistics / limits

Uptime:             0 seconds
Run queue:          1
Atoms:              14791 / 1048576 (1% used)
ETS:                19 / 8192 (0% used)
Ports:              3 / 65536 (0% used)
Processes:          48 / 262144 (0% used)

Showing topics:     [:system, :memory, :limits]
Additional topics:  [:allocators, :applications]

To view a specific topic call runtime_info(topic)
```

ã“ã®ã‚„ã‚Šæ–¹ã¯ ExUnit ã® CaputureIO ãŒæ¨™æº–å‡ºåŠ›ã‚’å–å¾—ã—ã¦ã„ãŸã®ã‚’æ€ã„å‡ºã—ã¦[èª¿ã¹ãŸçµæœ](https://github.com/elixir-lang/elixir/blob/v1.9.4/lib/ex_unit/lib/ex_unit/capture_io.ex#L112-L125)æ€ã„ã¤ã„ãŸã€‚
